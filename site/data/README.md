# Call.Sofia 3D Map Data Format

## Структура на данните

### data/call.sofia.dump.kvartali.csv

Колони
1. id: Уникален номер на квартал
2. name: Име на квартала

### data/call.sofia.dump.regions.csv

Колони
1. id: Уникален номер на район
2. name: Име на района
3. population_estimate: Приблизителна оценка на населението спрямо последното преброяване

### data/call.sofia.names.csv

Колони
1. callid: Номер на сигнала в Call.Sofia
2. name: Заглавие на сигнала - първите 30 символа

### data/call.sofia.reports.csv

Колони
1. id: референция към кода на колоната в картата на Mapbox. Виж секцията по-долу.
2. category: Номер на категорията
3. subm: Дата на подаване във формат YYmmDD - последни две цифри на годината, номер на месец и ден от месеца без други символи
4. laststate: Номер на последен статус
5. daystostate: Изминали дни до последен статус - от деня на подаване до датата на последния статус
6. callid: Номер на сигнала в Call.Sofia
7. region: Уникален номер на квартал
8. kvartal: Уникален номер на район

### Категории:

- 1: Чистота
- 2: Водоснабдяване и канализация
- 3: Пътна инфраструктура
- 4: Пътна сигнализация
- 5: Паркиране
- 6: Екология. Зелена система
- 7: Домашни и стопански животни
- 8: Търговия, реклама и преместваеми обекти
- 9: Сгради/строежи
- 11: Други
- 22: Проблеми с кучета
- 27: Сметосъбиране и сметоизвозване
- 28: Улично осветление
- 30: Замърсяване на обществени площи
- 32: Детски площадки
- 38: Масов градски транспорт
- 39: COVID-19
- 40: Спортни терени, площадки и съоръжения

### Статуси:

- 0: Неизвестен
- 1: Чакащ обработка
- 2: В процес на обработка
- 3: Очакващ отговор
- 4: Получил уведомление
- 5: Приключен
- 6: Отхвърлен

## Кодиране на данните

### Идентификатор на колона

Става дума за полето "id" от файла data/call.sofia.reports.csv. Тук давам пример с php код

```
$barsize=50; 
$barsizelat = $barsize/6378137 * 180/pi();
$barsizelng = $barsize/(6378137*cos(pi()*42.2/180)) * 180/pi();
$bounds=array(23.051,42.412);
$encodeMap="0123456789abcdefghijklmnopqrstuvwxyz";

$coords=array(23.27958,42.69362);

$keya=floor((floatval($coords[0])-$bounds[0])/$barsizelng);
$keyb=floor((floatval($coords[1])-$bounds[1])/$barsizelat);
$keya=substr($encodeMap,floor($keya/36),1).substr($encodeMap,$keya%36,1);
$keyb=substr($encodeMap,floor($keyb/36),1).substr($encodeMap,$keyb%36,1);
$id=$keya.$keyb;

```




